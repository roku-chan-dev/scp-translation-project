{
  "title": "タイトル検索",
  "content": "[[include :scp-jp:credit:start |mode=no-rate]]\n**タイトル:** タイトル検索\n**著者:** SCP財団\n**作成年:** 2023\n----\n本ページはSCPコミュニティのために作成され，SCP財団に帰属します．本ページの管理は[[[meet-the-staff-jp|サイトスタッフ]]]に委任されています．\n[[include :scp-jp:credit:end]]\n\n[[html]]\n<!--\nCreated by R74 2023\nhttps://www.r74tech.com/search.txt\n\n-->\n    <!DOCTYPE html>\n<html>\n<head>\n    <title>タイトル検索</title>\n    <link href=\"https://cdnjs.cloudflare.com/ajax/libs/bulma/0.9.4/css/bulma.min.css\" rel=\"stylesheet\">\n    <link href=\"https://cdn.jsdelivr.net/npm/bulma-extensions@4.0.0/dist/css/bulma-extensions.min.css\" rel=\"stylesheet\">\n    <script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js\">\n    </script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bulma-extensions@4.0.0/dist/js/bulma-extensions.min.js\">\n    </script>\n    <style>\n     .search-text {\n        white-space: pre-line;\n     }\n     .panel-block {\n     white-space: nowrap;\n     overflow: hidden;\n     text-overflow: ellipsis;\n     }\n    </style>\n</head>\n<body>\n    <section class=\"section p-0\">\n     <div class=\"container\">\n     <form class=\"mb-5\" id=\"search-form\" name=\"search-form\">\n     <div class=\"field\">\n     <div class=\"control\">\n     <input class=\"input\" id=\"search-input\" placeholder=\"5件まで表示されます\" type=\"text\">\n     </div>\n     </div>\n     <div class=\"field is-grouped is-align-items-center is-flex-wrap-wrap\">\n     <div class=\"control pt-1\">\n     <button class=\"button is-info\" type=\"submit\">検索</button>\n     </div>\n     <div class=\"control pt-1\">\n     <button class=\"button is-light\" id=\"show-history\" type=\"button\">履歴</button>\n     </div>\n     </div>\n     </form>\n     <hr>\n     <div class=\"panel\" id=\"search-history\" style=\"display: none;\">\n     <p class=\"panel-heading\">検索履歴</p>\n     <div id=\"search-history-list\"></div>\n     </div>\n     <div class=\"panel\" id=\"search-boxes\"></div>\n     <div id=\"html-boxes\" style=\"display: none;\"></div>\n     <div id=\"error-container\"></div>\n     <footer class=\"mt-5\" id=\"footer\">\n     <p><a href=\"https://crom.avn.sh/\" target=\"_blank\">Powered by Crom</a></p>\n     </footer>\n     </div>\n    </section>\n    <script>\n                      const graphqlQuery = `\n       query metaTitleSearch($query: String!) {\n        searchPages(\n          query: $query\n          filter: {anyBaseUrl: \"http://scp-jp.wikidot.com/\"}\n        ) {\n          url\n          wikidotInfo {\n            title\n          }\n          alternateTitles{\n            title\n          }\n        }\n       }\n       `;\n\n          $(document).ready(function () {\n              const searchInput = $(\"#search-input\");\n              const searchBoxes = $(\"#search-boxes\");\n              const errorContainer = $(\"#error-container\");\n              const searchHistoryPanel = $(\"#search-history\");\n              const searchHistoryList = $(\"#search-history-list\");\n              const showHistoryButton = $(\"#show-history\");\n\n              // LocalStorageから検索履歴を取得\n              const searchHistory = JSON.parse(localStorage.getItem(\"searchHistory\")) || [];\n\n              // 検索履歴を画面に表示\n              updateSearchHistoryDisplay();\n\n              // LocalStorageから検索クエリを取得して設定\n              const lastQuery = localStorage.getItem(\"lastSearchQuery\");\n              if (lastQuery) {\n                  searchInput.val(lastQuery);\n              }\n       function performSearch(query) {\n          searchInput.val(query);\n\n          // 検索結果とエラーコンテナをクリア\n          searchBoxes.empty();\n          errorContainer.empty();\n\n          // Ajaxリクエストを送信\n          $.ajax({\n              url: \"https://api.crom.avn.sh/graphql\",\n              contentType: \"application/json\",\n              type: \"POST\",\n              data: JSON.stringify({\n                  query: graphqlQuery,\n                  variables: {\n                      query: query\n                  }\n              }),\n              success: function (response) {\n                  const pages = response.data.searchPages;\n                  pages.forEach(page => {\n                      const title = page.wikidotInfo.title;\n                      const metatitle = page.alternateTitles[0] ? \" - \" + page.alternateTitles[0].title : '';\n                      const url = page.url;\n                      const link = `<a class=\"panel-block\" href=\"${url}\" target=\"_blank\"><strong>${title}<\\/strong>${metatitle}<\\/a>`;\n                      searchBoxes.append(link);\n                  });\n              },\n              error: (jqXHR, textStatus, errorThrown) => {\n                  showError(`An error occurred during the Ajax request:\\nHTTP status: ${jqXHR.status} ${jqXHR.statusText}\\nResponse text: ${jqXHR.responseText}\\nError thrown: ${errorThrown}`);\n              }\n          });\n       }\n\n       $(\"#search-form\").submit(function (event) {\n          event.preventDefault();\n\n          // クエリを取得\n          const query = searchInput.val().trim();\n          if (!query) return;\n\n          // 検索履歴を更新\n          if (searchHistory.indexOf(query) === -1) {\n              searchHistory.unshift(query);\n              if (searchHistory.length > 20) {\n                  searchHistory.pop();\n              }\n              localStorage.setItem(\"searchHistory\", JSON.stringify(searchHistory));\n              updateSearchHistoryDisplay();\n          }\n\n          // LocalStorageにクエリを保存\n          localStorage.setItem(\"lastSearchQuery\", query);\n\n          // 検索実行\n          performSearch(query);\n       });\n\n       function updateSearchHistoryDisplay() {\n          searchHistoryList.empty();\n          searchHistory.forEach(item => {\n              const historyItem = $('<a class=\"panel-block\" href=\"#\">' + item + '<\\/a>');\n              historyItem.click(function () {\n                  searchHistoryPanel.hide();\n                  performSearch(item);\n              });\n              searchHistoryList.append(historyItem);\n          });\n       }\n              showHistoryButton.click(function () {\n                  searchHistoryPanel.toggle();\n              });\n\n\n              function showError(message) {\n                  const errorBox = $(\"<div><\\/div>\").addClass(\"notification is-danger\").text(message);\n                  errorContainer.append(errorBox);\n              }\n          });\n    </script>\n</body>\n</html>\n\n[[/html]]\n[[span class=\"loading_container\"]][[span class=\"loading\"]][[span]]L[[/span]][[span class=\"animate\"]]O[[/span]][[span class=\"animate\"]]A[[/span]][[span class=\"animate\"]]D[[/span]][[span]]I[[/span]][[span]]N[[/span]][[span]]G[[/span]][[/span]][[/span]]\n\n\n\n\n+ 説明\n入力したタイトル/メタタイトルの検索候補をCrom APIのデータに基づき検索します。\n\n\n+ 使い方\n入力欄に調べたいタイトルを入力し，\"検索\"ボタンを押してください。\n\n+ その他\nわからない事やバグと思われる動作の報告はこのページのディスカッションにお願いします。バグ報告の場合は検索したページ（検索した語句をそのままコピペするのが望ましい）を記述していただけると幸いです。\n\n\n\n[[module css]]\n@keyframes spin {\n    0% {\n     top: 0;\n    }\n    50% {\n     top: 100%;\n     opacity: 0;\n    }\n    51% {\n     top: -100%;\n    }\n    100% {\n     top: 0;\n     opacity: 1;\n    }\n}\n@-webkit-keyframes spin {\n    0% {\n     top: 0;\n    }\n    50% {\n     top: 100%;\n     opacity: 0;\n    }\n    51% {\n     top: -100%;\n    }\n    100% {\n     top: 0;\n     opacity: 1;\n    }\n}\n\n#page-content>p {\n    position: relative;\n    width: 100%;\n}\niframe.html-block-iframe {\n    margin-bottom: 130px;\n}\niframe.html-block-iframe[style] {\n    margin: 0;\n}\n\niframe.html-block-iframe[style]+*+.loading_container {\n    z-index: -1;\n    opacity: 0;\n}\n\n.loading_container {\n    padding: 50px 0;\n    background: aliceblue;\n    display: block;\n    position: absolute;\n    width: 100%;\n    top: 0;\n    transition: opacity 300ms, z-index 500ms;\n    opacity: 1;\n    z-index: 0;\n}\n.loading {\n    position: relative;\n    width: 100%;\n    text-align: center;\n    display: block;\n    line-height: 2em;\n}\n.loading span {\n    color: #000;\n    font-size: 2em;\n}\n.loading .animate {\n    position: absolute;\n    top: 0;\n}\n.loading span:nth-child(2) {\n    color: #0088cc;\n    animation: spin 1.5s linear infinite;\n    -webkit-animation: spin 1.5s linear infinite;\n}\n.loading span:nth-child(3) {\n    margin-left: 25px;\n    color: #e23069;\n    animation: spin 1s linear infinite;\n    -webkit-animation: spin 1s linear infinite;\n}\n.loading span:nth-child(4) {\n    margin-left: 50px;\n    color: #F0E300;\n    animation: spin 1.25s linear infinite;\n    -webkit-animation: spin 1.25s linear infinite;\n}\n.loading span:nth-child(5) {\n    padding-left: 77px;\n}\n[[/module]]\n\n++* Change Log\n[[div class=\"code\"]]\nCreated by R74 2023\nMIT License: @@https://r74tech.com/license.txt@@\n\n[1.0.0] - 2023-10-26\n- Initial release\n[[/div]]",
  "tags": [
    "jp",
    "外部連携",
    "管理"
  ],
  "author": "R74",
  "created_at": "2023-10-26T04:32:38+00:00",
  "updated_at": "2023-10-26T04:32:57+00:00",
  "rating": 14,
  "_site": "scp-jp",
  "_fullname": "titlesearch"
}