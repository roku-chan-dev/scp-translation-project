{
  "title": "在wikidot上播放midi并可视化",
  "content": "[[>]]\n[[module rate]]\n[[/>]]\n@@ @@\n@@ @@\n+ 1.说明\n\n本页面用于介绍如何在wikidot中嵌入midi文件并展示相应的可视化效果，使用者**需要具备一定的HTML和CSS语法技能与音乐知识**。\n组件来源于[[[https://github.com/cifkao/html-midi-player|html midi播放器]]]，<midi-player> 和 <midi-visualizer> HTML 元素由 @magenta/music （Magenta.js） 提供支持，完全可设置样式和脚本。\n许可协议为BSD 2-Clause License\n[[collapsible show=\"+ 显示许可证\" hide=\"- 关闭\"]]\nCopyright (c) 2020, Ondřej Cífka\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this\n   list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice,\n   this list of conditions and the following disclaimer in the documentation\n   and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n[[/collapsible]]\n\n以下为本人使用“Lovely Composer”及其附带音色写的几首8bit风格示例歌曲，均适用于CC-BY-SA 3.0协议。\n\n++++ 《拉赫曼尼诺夫前奏曲-Remix》\n[[html]]\n<audio src=\"https://scpsandboxcn.wikidot.com/local--files/jand-test/Rachmaninoff.wav\" controls=\"controls\">wav</audio>\n[[/html]]\n[[collapsible show=\"+ 背景信息\" hide=\"- 关闭\"]]\nRachmaninoff - Prélude in C sharp minor, Op. 3, No. 2\n升c小调前奏曲\n原曲已进入公有领域，B站有相应的[[[https://www.bilibili.com/video/BV13B4y1S7qe|电子版本]]]\n\n以下介绍来自于wikipedia\n\n这首作品是19岁的拉赫曼尼诺夫在1892年5月29日从莫斯科音乐学院毕业后以“自由艺术家”的身份创作的首批作品之一。1892年9月26日，他在莫斯科电气展览会的一场音乐会上首次演奏了这首新作品。次年，它作为五首Morceaux de fantaisie （Op. 3）组曲中的第二首出版，全部献给他在音乐学院的和声老师安东·阿伦斯基。因为当时俄罗斯不是1886年伯尔尼公约的缔约国，俄罗斯出版商不支付版税，因此他从这篇文章中获得的唯一经济回报是40卢布（约合工厂工人两个月工资）的出版费。\n[[/collapsible]]\n\n++++ 《循环》\n[[html]]\n<audio src=\"https://scpsandboxcn.wikidot.com/local--files/jand-test/loop.wav\" controls=\"controls\">wav</audio>\n[[/html]]\n\n++++ 《空军进行曲-8bit》\n[[html]]\n<audio src=\"https://scpsandboxcn.wikidot.com/local--files/jand-test/air-march.wav\" controls=\"controls\">wav</audio>\n[[/html]]\n[[collapsible show=\"+ 背景信息\" hide=\"- 关闭\"]]\n斯大林空军进行曲/飞得更高(Авиамарш)\n\n也被称作飞行员进行曲（俄语：Марш авиаторов），是一首1923年创作的苏联歌曲，由尤里·海特作曲，帕维尔·赫尔曼作词。自1933年开始，该歌曲成为苏联空军的进行曲。(介绍来自于wikipedia)\n原曲已进入公有领域，B站有相应的[[[https://www.bilibili.com/video/BV1et411i7Ux/|传统版本]]]\n[[/collapsible]]\n\n++++ 《攻击战-8bit》\n[[html]]\n<audio controls src=\"https://scpsandboxcn.wikidot.com/local--files/jand-test/attack.mp3\"></audio>\n[[/html]]\n[[collapsible show=\"+ 背景信息\" hide=\"- 关闭\"]]\n《攻击战》（朝鲜语：공격전이다／攻擊戰이다 Gonggyeokjeonida）， 是一首朝鲜的歌曲，由朝鲜文学艺术总同盟旗下作曲家安正浩（안정호）作曲，尹斗根（윤두근）填词，由普天堡电子乐团的尹惠英演唱。2010年1月27日的《劳动新闻》中首次披露了这首歌的名称与歌词。歌词内容包含朝鲜著名的白头山、正日峰，以及对全体朝鲜国民勇气的夸赞。(介绍来自于wikipedia)\n\n原曲可能具有版权，但其目前已成为无版权歌曲，B站有相应的[[[https://www.bilibili.com/video/BV1q4411p7i3/|摇滚版本]]]\n[[/collapsible]]\n\n++++ 《塔朗泰拉-8bit》\n[[html]]\n<audio controls src=\"https://scpsandboxcn.wikidot.com/local--files/jand-test/tarantella.mp3\"></audio>\n[[/html]]\n[[collapsible show=\"+ 背景信息\" hide=\"- 关闭\"]]\n“Tarantella Napoletana”是路易吉·里奇 （Luigi Ricci） 于1852年创作的一首塔兰泰拉舞曲，即意大利传统舞曲，与那不勒斯有关。(介绍来自于wikipedia)\n\n原曲已进入公有领域，B站有相应的[[[https://www.bilibili.com/video/BV1nW411b7js/|传统版本]]]\n[[/collapsible]]\n\n\n值得注意的是，在浏览器上播放midi其使用的库中自带的音源，因此会与上述音频的音色不同，使用时需要注意。\n\n@@ @@\n@@ @@\n@@ @@\n@@ @@\n\n+ 2.演示\n++ 简单midi可视化\n+++ 普通midi样式\n**附注：通用的样式，适用于大部分midi**\n[[html]]\n<midi-player\n  loop\n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.4/attack.mid\"\n  sound-font visualizer=\"#myVisualizer\">\n</midi-player>\n<midi-visualizer type=\"piano-roll\" id=\"myVisualizer\"></midi-visualizer>\n\n<script src=\"https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0\"></script>\n\n[[/html]]\n\n+++ 五线谱样式\n**附注：五线谱样式更适合于简单曲调的midi**\n[[html]]\n\n<midi-player\n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.3/air-march.mid\"\n  sound-font=\"https://storage.googleapis.com/magentadata/js/soundfonts/salamander\"\n  visualizer=\"#myStaffVisualizer\">\n</midi-player>\n\n<midi-visualizer type=\"staff\" id=\"myStaffVisualizer\" \n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.2/loop.mid\">\n</midi-visualizer>\n\n<script src=\"https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0\"></script>\n\n[[/html]]\n\n+++ 瀑布样式\n**##red|注意：##本样式可能因为源JS库年久失修，现已出现了不能播放可视化的问题。**\n[[html]]\n<midi-player\n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.2/loop.mid\"\n  sound-font=\"https://storage.googleapis.com/magentadata/js/soundfonts/salamander\"\n  visualizer=\"#myWaterfallVisualizer\">\n</midi-player>\n\n<midi-visualizer type=\"waterfall\" id=\"myWaterfallVisualizer\" \n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.2/loop.mid\">\n</midi-visualizer>\n\n<script src=\"https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0\"></script>\n\n[[/html]]\n\n@@ @@\n@@ @@\n\n++ 高级midi显示\n\n风格已适配sigma-9版式\n\n[[html]]\n<style>\n/* Custom player style */\n#section1 midi-player {\n  display: block;\n  width: inherit;\n  margin: 4px;\n  margin-bottom: 0;\n}\n#section1 midi-player::part(control-panel) {\n  background: #fff;\n  border: 2px solid #000;\n  border-radius: 10px 10px 0 0;\n}\n#section1 midi-player::part(play-button) {\n  color: maroon;\n  border: 2px solid currentColor;\n  background-color: #fff;\n  border-radius: 20px;\n  transition: all 0.2s;\n  content: 'hello';\n}\n#section1 midi-player::part(play-button):hover {\n  color: maroon;\n  background-color: #fff;\n  border-radius: 10px;\n}\n#section1 midi-player::part(time) {\n  font-family: monospace;\n}\n\n/* Custom visualizer style */\n#section1 midi-visualizer .piano-roll-visualizer {\n  background: #fff;\n  border: 2px solid black;\n  border-top: none;\n  border-radius: 0 0 10px 10px;\n  margin: 4px;\n  margin-top: 0;\n  overflow: auto;\n}\n#section1 midi-visualizer svg rect.note {\n  opacity: 0.6;\n  stroke-width: 2;\n}\n#section1 midi-visualizer svg rect.note[data-instrument=\"0\"]{\n  fill: red;\n  stroke: red;\n}\n#section1 midi-visualizer svg rect.note[data-instrument=\"1\"]{\n  fill: green;\n  stroke: green;\n}\n#section1 midi-visualizer svg rect.note[data-instrument=\"2\"]{\n  fill: blue;\n  stroke: blue;\n}\n#section1 midi-visualizer svg rect.note[data-is-drum=\"true\"]{\n  fill: yellow;\n  stroke: yellow;\n}\n#section1 midi-visualizer svg rect.note.active {\n  opacity: 1;\n  stroke: maroon;\n}\n</style>\n\n<body>\n\n<section id=\"section1\">\n<midi-player\n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.5/tarantella.mid\"\n  sound-font visualizer=\"#section1 midi-visualizer\">\n</midi-player>\n<midi-visualizer\n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.5/tarantella.mid\">\n</midi-visualizer>\n</section>\n\n<script src=\"https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0\"></script>\n</body>\n\n[[/html]]\n##white|摩斯密码##\n@@ @@\n@@ @@\n----\n@@ @@\n@@ @@\n+ 3.使用\n++ 上传midi文件\n\n由于跨源资源共享（Cross-Origin Resource Sharing，CORS）问题，该JS库无法直接使用本地文件以及wikidot上的文件链接，这需要你拥有一个Github库，将文件上传到Github上即可解决该问题。\n\n考虑到国内**很可能**无法直接访问github，建议使用JsDeliver进行加速，简要的操作要领为：发布一个release，然后使用该链接即可：  \n> @@https://cdn.jsdelivr.net/gh/用户名/页面名@版本号>/文件名.midi@@。\n\n@@ @@\n@@ @@\n\n++ 嵌入代码方块\n\n以五线谱样式举例\n\n[[code type=\"html\"]]\n[[html]]\n\n<midi-player\n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.3/air-march.mid\"\n  sound-font=\"https://storage.googleapis.com/magentadata/js/soundfonts/salamander\"\n  visualizer=\"#myStaffVisualizer\">\n</midi-player>\n\n<midi-visualizer type=\"staff\" id=\"myStaffVisualizer\" \n  src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.2/loop.mid\">\n</midi-visualizer>\n\n<script src=\"https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0\"></script>\n\n[[/html]]\n[[/code]]\n\n其中的<midiplayer>标签为播放器部分，而<midi-visualizer>标签为midi可视化部分，其顺序与其相互位置相关。\n\n@@https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.2/loop.mid@@为笔者使用的URL，可见已经进行了cdn加速。\n\n<midi-visualizer>中的type有三种样式@@piano-roll@@/@@staff@@/@@waterfall@@，分别对应普通样式、五线谱样式、瀑布样式。\n\n其余midi可视化组件的参数可在[[[https://magenta.github.io/magenta-js/music/globals.html|magenta-js]]]中查询。\n\n最重要的是\n[[code type=\"html\"]]\n<script src=\"https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.4.0\"></script>\n[[/code]]\n标签，其指向改组件的JS库，也经过了CDN加速，每个html块中**必须包含**该原封不动的标签。\n\n同时，该插件可以更改midi音色，库中有三种内置音色，分别为：\n> 钢琴（@@https://storage.googleapis.com/magentadata/js/soundfonts/salamander@@）\n> 默认（@@https://storage.googleapis.com/magentadata/js/soundfonts/sgm_plus@@）\n> 爵士鼓（@@https://storage.googleapis.com/magentadata/js/soundfonts/jazz_kit@@）\n更改相应的sound-font链接即可，也可以使用相同的方法在github上上传你想用的音色，再使用类似的方法引用。\n@@ @@\n@@ @@\n\n++ 定制高级样式\n\nmidi可视化可以使用对应的CSS样式，例如上文展示的（已加入注释）：\n\n[[code type=\"css\"]]\n<style>\n/* 自定义 MIDI 播放器样式 */\n#section1 midi-player {\n  display: block; /* 让播放器以块级元素显示 */\n  width: inherit; /* 继承父级的宽度 */\n  margin: 4px; /* 设置播放器的外边距 */\n  margin-bottom: 0; /* 底部外边距设置为 0 */\n}\n#section1 midi-player::part(control-panel) {\n  background: #fff; /* 控制面板背景颜色为白色 */\n  border: 2px solid #000; /* 边框为黑色，宽度 2px */\n  border-radius: 10px 10px 0 0; /* 圆角设置：上两个角为圆角，下两个为直角 */\n}\n#section1 midi-player::part(play-button) {\n  color: maroon; /* 播放按钮的颜色为栗色 */\n  border: 2px solid currentColor; /* 边框颜色与当前文本颜色一致 */\n  background-color: #fff; /* 背景色为白色 */\n  border-radius: 20px; /* 按钮圆角设置为 20px */\n  transition: all 0.2s; /* 添加过渡效果，使样式切换更平滑 */\n  content: 'hello'; /* 设置伪元素内容为 'hello'（无实际效果，但可修改显示内容） */\n}\n#section1 midi-player::part(play-button):hover {\n  color: maroon; /* 鼠标悬停时，按钮文本颜色保持栗色 */\n  background-color: #fff; /* 悬停时背景色保持白色 */\n  border-radius: 10px; /* 悬停时改变圆角为 10px */\n}\n#section1 midi-player::part(time) {\n  font-family: monospace; /* 时间显示使用等宽字体 */\n}\n\n/* 自定义 MIDI 可视化样式 */\n#section1 midi-visualizer .piano-roll-visualizer {\n  background: #fff; /* 可视化背景颜色为白色 */\n  border: 2px solid black; /* 黑色边框，宽度 2px */\n  border-top: none; /* 顶部边框取消 */\n  border-radius: 0 0 10px 10px; /* 设置下两个角为圆角 */\n  margin: 4px; /* 外边距为 4px */\n  margin-top: 0; /* 顶部外边距设置为 0 */\n  overflow: auto; /* 超出内容可滚动 */\n}\n#section1 midi-visualizer svg rect.note {\n  opacity: 0.6; /* 音符矩形透明度为 0.6 */\n  stroke-width: 2; /* 描边宽度为 2 */\n}\n#section1 midi-visualizer svg rect.note[data-instrument=\"0\"] {\n  fill: red; /* 设置乐器 0 的音符颜色为红色 */\n  stroke: red; /* 描边颜色为红色 */\n}\n#section1 midi-visualizer svg rect.note[data-instrument=\"1\"] {\n  fill: green; /* 设置乐器 1 的音符颜色为绿色 */\n  stroke: green; /* 描边颜色为绿色 */\n}\n#section1 midi-visualizer svg rect.note[data-instrument=\"2\"] {\n  fill: blue; /* 设置乐器 2 的音符颜色为蓝色 */\n  stroke: blue; /* 描边颜色为蓝色 */\n}\n#section1 midi-visualizer svg rect.note[data-is-drum=\"true\"] {\n  fill: yellow; /* 打击乐音符的颜色为黄色 */\n  stroke: yellow; /* 打击乐音符的描边颜色为黄色 */\n}\n#section1 midi-visualizer svg rect.note.active {\n  opacity: 1; /* 激活的音符透明度为 1 */\n  stroke: maroon; /* 激活音符的描边颜色为栗色 */\n}\n</style>\n\n<body>\n\n<!-- 定义一个包含 MIDI 播放器和可视化工具的部分 -->\n<section id=\"section1\">\n  <!-- MIDI 播放器组件 -->\n  <midi-player\n    src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.1/Rachmaninoff.mid\" \n    sound-font visualizer=\"#section1 midi-visualizer\">\n  </midi-player>\n  <!-- MIDI 可视化组件 -->\n  <midi-visualizer\n    src=\"https://cdn.jsdelivr.net/gh/msjand/live2d-jand@0.0.1/Rachmaninoff.mid\">\n  </midi-visualizer>\n</section>\n\n<!-- 引入相关库文件 -->\n<script src=\"https://cdn.jsdelivr.net/combine/npm/tone@14.7.58,npm/@magenta/music@1.23.1/es6/core.js,npm/focus-visible@5,npm/html-midi-player@1.5.0\"></script>\n\n</body>\n\n[[/code]]\n\n@@ @@\n@@ @@\n@@ @@\n@@ @@",
  "tags": [
    "原创",
    "文章",
    "艺术作品",
    "音频"
  ],
  "author": "Mr_J_AND",
  "created_at": "2025-01-02T16:42:12+00:00",
  "updated_at": "2025-01-04T13:28:23+00:00",
  "rating": 38,
  "_site": "scp-wiki-cn",
  "_fullname": "web-midi"
}