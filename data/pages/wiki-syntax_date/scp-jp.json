{
  "title": "日付",
  "content": "pWikidotにおけるいくつかのページ（フォーラム、プライベートメッセージ、最新版更新日　等）では（カーソルが重ねられた際、もしくは直接記述された形で）経過時間を自動的に計算する日付及びタイムスタンプを使用しています。例えば\n* [[date 1237135440 format=\"%e %b %Y, %H:%M %Z|agohover\"]] (カーソルをこの日付の上に置き表示される文章を見てください) もしくは\n* [[date 1237135440 format=\"%c\"]]\n\nもしあなたが自分のページに「どれぐらい時間が経ったか」を自動的に伝える日付を掲載したいのであれば、ここであなたにその方法を教えます。\n\n++ [[# how]] 使い方\n\n下記の構文を要します:\n> {{@@[[date@@ //timestamp// <format=\"//format//@@<|agohover>\">]]@@}}\n\n構文\n* < ... > 任意のパラメータを意味します\n* {{//timestamp//}} は1970年1月1日から任意の日付までの秒数を記述します。特定の日付をこの数字に変換したい場合は[#wizard Code Wizard]以下をご参照ください。\n* {{//format//}}は//[http://community.wikidot.com/howto:frontforum-date-variable#modifiers %modifiers]//を含み得る、実際に表示される日付もしくは時間に変換される任意の文字列です。{{//format//}} を指定しない場合は\"%e''が標準で設定されます。\n* {{|agohover}} は{{//format//}}で規定した文章が表示されている時、その文章にカーソルが重なった時に表示されるホバーテキスト (\"//時間に応じて// 秒/分/時間/日 ago\") を指定します。\n\n++ [[# wizard]][[# example]]Code Wizard[[footnote]] 原文に掲載されていた[http://www.wikidot.com/doc-wiki-syntax:date#wizard Code Wizard]を[[*user C-take]]が改良したものです[[/footnote]]\n自身のページに特定の日付からの経過日数を表示する際に必要なコードを見つけ出します:\n[[html]]\n<head>\n\t<!--Created by ErichSteinboeck 2008-->\n\t<style type=\"text/css\">\n\t\t@import url('/common--theme/base/css/style.css');\n\t\t#main-content {margin: 0; padding: 0;}\n\t</style>\n\t<script type=\"text/javascript\" src=\"/common--javascript/init.combined.js\"></script>\n\t<script type=\"text/javascript\" src=\"/common--javascript/WIKIDOT.combined.js\"></script>\n\t<script  type=\"text/javascript\">\n\tOZONE.request.timestamp = Math.floor(new Date().getTime()/1000);\n\tOZONE.request.date = new Date();\n\n<!-- Begin\n\twindow.addEventListener(\"message\",function(event){\n\t\tvar checkC = event.data.indexOf(\",\");\n\t\tif(checkC < 0){\n\t\t\treturn;\n\t\t}\n\t\tif(event.data.substring(0,checkC) == \"response\")\n\t\t{\n\t\t\tdocument.getElementById('output').innerHTML = event.data.substring(checkC+1,event.data.length);\n\t\t\twindow.parent.window.subDate.window.postMessage(\"\",\"*\");\n\t\t}\n\t});\n\t\nvar initializeRun = true;\n//-- Load dropdown lists with values ----------------------------\nfunction loadLists() {\n\n  //-- Populate a dropdown list ---------------------------------\n  function loadList(options, from, to, minLength, selected) {\n\n    var text;\n\n    for (var i = from; i < to+1; i++) {\n      text = i.toString();\n      if (text.length<minLength)\n        text = '0000'.substr(1,minLength-text.length)+text;\n      options[i-from] = new Option(text);\n    }\n    options[selected-from].selected = true;\n  }\n\n  // Clear \"no javascript\" warning\n  document.getElementById('no_js').firstChild.data = '';\n\n  // Load all dropdown lists and select current date/time\n  var current=new Date();\n  var months = [\"1月\", \"2月\", \"3月\", \"4月\", \"5月\", \"6月\", \"7月\", \"8月\", \"9月\", \"10月\", \"11月\", \"12月\"];\n\n  with (document.timestamp) {\n    for (var i = 0; i < 12; i++)\n      month.options[i] = new Option(months[i]);\n    month.options[current.getMonth()].selected = true;\n    loadList(day.options, 1, 31, 1, current.getDate());\n    loadList(year.options, 1960, current.getFullYear(), 4, current.getFullYear());\n    loadList(hour.options, 0, 23, 2, current.getHours());\n    loadList(minute.options, 0, 59, 2, current.getMinutes());\n  }\n\n  adaptDayList(current.getMonth(), current.getFullYear());\n}\n\n//-- Adapt \"day\" dropdown list --------------------------------\nfunction adaptDayList(month, year) {\n\n  // calculate last day of month/year\n  var dayOne = new Date(month<12?year:year+1, month<12?month+1:1, 1);\n  var maxDays = new Date(dayOne.getTime()-1000).getDate();\n\n  with (document.timestamp.day) {\n    if (selectedIndex > maxDays-1)\n      selectedIndex = maxDays-1;\n    for (var i = options.length; i < maxDays; i++)\n      options[i] = new Option(i+1);\n    if (options.length != maxDays)\n      options.length = maxDays;\n  }\n}\n\n//-- Calculate timestamp from selection --------------------------------\nfunction calculate() {\n\n  // Calculate timestamp\n  with (document.timestamp) {\n    adaptDayList(month.selectedIndex, year.selectedIndex);\n    var ts = new Date(year.selectedIndex+1960, month.selectedIndex, day.selectedIndex+1, hour.selectedIndex, minute.selectedIndex);\n  }\n\n  // Write timestamp to code & output\n  var time = Math.floor(ts.getTime()/1000);\n  var text;\n\n  text = time;\n  if (document.formatstring.format.value != '')\n    text = time + ' format=\"' + document.formatstring.format.value  + '\"';\n  document.getElementById('code').firstChild.data = text;\n\n  text = time;\n  if (document.formatstring.format.value != ''){\n    text = time + '|' + document.formatstring.format.value;\n\t}\n\tif( initializeRun){\n\t\tdocument.getElementById('output').firstChild.data = text;\n\t}else{\n\t\twindow.parent.window.subDate.window.postMessage(\"request,\"+text,\"*\");\n\t}\n  <!--CODE TO UPDATE THE CHANGED ODATE GOES HERE-->\n}\n\n//-- Initial load for dropdown lists and initial calculate() ---------------\nfunction initialize() {\n  loadLists();\nchangeTableStyle();\n  document.formatstring.format.value = '%Y年 %m月 %d日, %H:%M %Z|agohover'\n  calculate();\n initializeRun = false;\n}\n\n        function isUseSmartPhone(){\n            return (((navigator.userAgent.indexOf('iPhone') > 0 && navigator.userAgent.indexOf('iPad') == -1) || navigator.userAgent.indexOf('iPod') > 0 || navigator.userAgent.indexOf('Android') > 0));\n        }\n\nfunction changeTableStyle(){\n\tvar table = document.getElementById(\"displayTable\");\n\tvar resultTable = document.getElementById(\"ResultTable\");\n\t\t\tvar SelectButton = document.getElementById(\"forSmartPhone\");\n\t\tSelectButton.parentNode.removeChild(SelectButton);\n\tvar isUserPhone = isUseSmartPhone();\n\tif(isUserPhone){\n\t\tvar formatArea = document.getElementById(\"formatArea\");\n\t\tformatArea.removeAttribute(\"size\");\n\t\tformatArea.setAttribute(\"style\",\"width:100%;\");\n\t\tvar newStyle = \"width:100%;table-layout:fixed;font-break:break-all;\";\n\t\ttable.setAttribute(\"style\",newStyle);\n\t\tvar oldStyle = resultTable.getAttribute(\"style\");\n\t\tnewStyle = newStyle+oldStyle;\n\t\tresultTable.removeAttribute(\"style\");\n\t\tresultTable.setAttribute(\"style\",newStyle);\n\t\treplasticTable(\"SlectDate\");\n\t\treplasticTable(\"DecideFormat\");\n\t\tvar ChildOfChild = new Array();\n\t\tvar trParent = resultTable.getElementsByTagName(\"tr\")[0].parentNode;\n\t\twhile(trParent.children.length > 0){\n\t\t\tvar tmpChild = trParent.children[0].children;\n\t\t\tfor(var j = 0;j < 2;j++){\n\t\t\t\tChildOfChild.push(tmpChild[j]);\n\t\t\t}\n\t\t\ttrParent.removeChild(trParent.children[0]);\n\t\t}\n\t\tfor(var i = 0;i<4;i++){\n\t\t\tvar Newtr = document.createElement(\"tr\");\n\t\t\tvar index = 0;\n\t\t\tswitch(i){\n\t\t\t\tcase 1:\n\t\t\t\t\tindex = 2;\n\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tindex = 1;\n\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tindex = 3;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tChildOfChild[index].setAttribute(\"colspan\",\"2\");\n\t\t\tif(index == 2){\n\t\t\t\tSelectButton.style.display = \"block\";\n\t\t\t\tChildOfChild[index].appendChild(SelectButton);\n\t\t\t}\n\t\t\tNewtr.appendChild(ChildOfChild[index]);\n\n\t\t\ttrParent.appendChild(Newtr);\n\n\t\t}\n\n\t}else{\nvar codeResult = document.getElementById(\"codeResult\");\ncodeResult.parentNode.appendChild(SelectButton);\nSelectButton.style.display = \"block\";\n}\n\n}\n\nfunction replasticTable(idName){\nvar TargetParent = document.getElementById(idName);\nvar ChildrenNode = TargetParent.children;\nChildrenNode[0].setAttribute(\"colspan\",\"2\");\nChildrenNode[1].setAttribute(\"colspan\",\"2\");\nvar AfterChild = ChildrenNode[1];\nTargetParent.removeChild(ChildrenNode[1]);\n\nvar NewTr = document.createElement(\"tr\");\nNewTr.appendChild(AfterChild);\nTargetParent.after(NewTr);\n}\n\n//  End -->\n</script>\n</head>\n\n<body id=\"html-body\" onload=\"initialize();\">\n<div id=\"container-wrap\">\n<div id=\"container\">\n<div id=\"content-wrap\">\n<div id=\"main-content\">\n<div id=\"page-content\">\n<table id=\"displayTable\"><tr id=\"SlectDate\">\n<td><ul><li>必要な日付もしくは時間を選択してください</li></ul>\n</td><td style=\"padding:0 0 0 1em\">\n<form name=\"timestamp\" onsubmit=\"return false;\">\n<select name=\"year\" onkeyup=\"calculate();\" onchange=\"calculate();\">\n<option>2008</option>\n</select>\n<select name=\"month\" onkeyup=\"calculate();\" onchange=\"calculate();\">\n<option>Aug</option>\n</select>\n<select name=\"day\" onkeyup=\"calculate();\" onchange=\"calculate();\">\n<option>27</option>\n</select>\n&nbsp;\n<select name=\"hour\" onkeyup=\"calculate();\" onchange=\"calculate();\">\n<option>20</option>\n</select>:<select name=\"minute\" onkeyup=\"calculate();\" onchange=\"calculate();\">\n<option>51</option>\n</select>\n</form></td></tr><tr id=\"DecideFormat\">\n<td><ul><li>更に<em><a href=\"http://community.wikidot.com/howto:frontforum-date-variable#modifiers\" target=\"_parent\">format</a></em>を記入してください</li></ul></td>\n<td style=\"padding:0 0 0 1em\">\n<form name=\"formatstring\" onsubmit=\"return false;\">\n<input name=\"format\" type=\"text\" size=\"50\" id=\"formatArea\" onkeyup=\"calculate();\" value=\"%Y年 %m月 %d日, %H:%M %Z|agohover\">\n</form></td></tr></table>\n<span id=\"no_js\">JavaScriptを有効にしてください …</span>\n<br>\n<table style=\"border-collapse:collapse;border-top:2px solid;border-bottom:2px solid;table-layout:fixed;width:100%;\" id=\"ResultTable\">\n<tr>\n<td style=\"padding:3px 1em 3px 0\"><em><strong>構文…</strong></em></td>\n<td><em><strong>表示 …</strong></em></td>\n</tr>\n<tr style=\"border-top:1px solid\">\n<td style=\"padding:3px 1em 3px 0\">\n<div class=\"code\" id=\"codeResult\">\n<pre>\n<code>[[date <span id=\"code\">format=\"1219863060%Y年 %m月 %d日, %H:%M %Z|agohover\"</span>]]</code>\n</pre>\n</div>\n</td>\n<td><span id=\"output\" class=\"odate\">1219863060|%Y年 %m月 %d日, %H:%M %Z|agohover</span></td>\n</tr>\n</table>\n<div id=\"forSmartPhone\" style=\"display:none;width:100%;\">\n<button style=\"width:100%;\" onclick=\"(function(){\nvar oldSelect = window.getSelection();\nwhile(oldSelect.rangeCount > 0){\noldSelect.removeRange(oldSelect.getRangeAt(0));\n}\nvar code = document.getElementById('codeResult');\nvar range = document.createRange();\nrange.selectNodeContents(code);\nwindow.getSelection().addRange(range);\n})()\">構文全選択</button>\n</div>\n</div></div></div></div></div>\n<div style=\"display:none\" id=\"dummy-ondomready-block\"></div>\n</body>\n[[/html]]\n表示されたコードをコピーして自身のページに貼り付けてください。\n\n++ [[# examples]]構文例\n[[table style=\"border-collapse:collapse;border-top:2px solid;border-bottom:2px solid\"]]\n[[row]]\n[[cell style=\"padding:3px 1em 3px 0\"]]//**記述例**//[[/cell]][[cell]]//**表示**//[[/cell]]\n[[/row]]\n[[row style=\"border-top:1px solid\"]]\n[[cell style=\"padding:3px 1em 3px 0\"]]{{@@[[date 1216153821]]@@}}[[/cell]]\n[[cell]][[date 1216153821]][[/cell]]\n[[/row]]\n[[row style=\"border-top:1px solid\"]]\n[[cell style=\"padding:3px 1em 3px 0\"]]{{@@[[date 1216153821 format=\"%d. %m. %Y|agohover\"]]@@}}[[/cell]]\n[[cell]][[date 1216153821 format=\"%d. %m. %Y|agohover\"]][[/cell]]\n[[/row]]\n[[row style=\"border-top:1px solid\"]]\n[[cell style=\"padding:3px 1em 3px 0\"]]{{@@[[date 681746400 format=\"James is %O young\"]]@@}}[[/cell]]\n[[cell]][[date 681746400 format=\"James is %O young\"]][[/cell]]\n[[/row]]\n[[row style=\"border-top:1px solid\"]]\n[[cell style=\"padding:3px 1em 3px 0\"]]{{@@+++ Minutes from [[date 1234567890 format=\"%e %B|agohover\"]]@@}}[[/cell]]\n[[cell]]\n+++* Minutes from [[date 1234567890 format=\"%e %B|agohover\"]]\n[[/cell]]\n[[/row]]\n[[/table]]\n\n注意点: 未来の日付に対しても %O を使用する事ができます。\n[[embed]]\n<iframe style=\"display:none;\" src=\"http://ja.scp-wiki.net/wiki-syntax:date/code/1\" name=\"subDate\"></iframe>\n[[/embed]]\n**著者**\ncreated by [[*user ErichSteinboeck]]\n[!--\n[[code type=\"html\"]]\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html lang=\"ja\">\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n\t<title>Wikidot Date Wizard</title>\n\t<script type=\"text/javascript\" src=\"https://scp-jp.github.io/files/util/common/scripts/regex.js\"></script>\n\t\t\t<script type=\"text/javascript\" src=\"/common--javascript/init.combined.js\"></script>\n\t<script type=\"text/javascript\" src=\"/common--javascript/WIKIDOT.combined.js\"></script>\n\n\t<script  type=\"text/javascript\">\n\tOZONE.request.timestamp = Math.floor(new Date().getTime()/1000);\n\tOZONE.request.date = new Date();\n\tvar url = location.href;\n\tvar pureURL = url;\n\tvar PermitSend = \"\";\n\tvar check = -1;\n\tvar loopSend = true;\n\tvar debug = true;\n\tvar RequestFormat = \"\";\n\n\t\t\n\tfunction initialize(){\n\tcheck = url.indexOf(\"#\");\n\t if(check < 0){\n\t\treturn;\n\t }\n\t\tpureURL = url.substring(0,check);\n\t\tvar data =decodeURIExtension(url.substring(check+1,url.length));\n\t\tRequestFormat = data;\n\t\t\n\t\tdocument.getElementById(\"output\").firstChild.data =RequestFormat;\t\nsetTimeout(LoopSend,5);\n\t}\n\t\n\tfunction LoopSend(){\n\n\t\tif(document.getElementById(\"output\").firstChild.data != \"\" ){\n\t\t\n\t\t\tif(RequestFormat != document.getElementById(\"output\").innerHTML)\n\t\t\t{\n\t\t\t\tvar iframes = window.parent.window.frames;\n\t\t\t\tfor(var i = 0;i < iframes.length;i++){\n\t\t\t\t\tiframes[i].window.postMessage(\"response,\"+document.getElementById(\"output\").innerHTML,\"*\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(loopSend){\n\t\t\tsetTimeout(LoopSend,5);\n\t\t}\n\t}\n\t\n\twindow.addEventListener(\"message\",function(event){\n    //リクエストを受け取るまでこのスクリプトは始動しない\n\t\tif(event.data == \"\"){\n\t\t\tloopSend = false;\n\t\t\treturn;\n\t\t}\n\t\tvar checkC = event.data.indexOf(\",\");\n\t\tif(checkC < 0){\n\t\t\tloopSend = false;\n\t\t\treturn;\n\t\t}\n\t\tvar runType = event.data.substring(0,checkC);\n\t\tif(runType == \"request\")\n\t\t{\n\t\t\tloopSend = false;\n\t\t\tRequestFormat = event.data.substring(checkC+1,event.data.length);\n\t\t\tlocation.href = pureURL + \"#\" + RequestFormat;\n\t\t\tlocation.reload();\n\t\t}\n\t});\n\t</script>\n\n</head>\n<body id=\"html-body\" onload=\"initialize();\">\n</body>\n<span id=\"output\" class=\"odate\">1219863060|%Y年 %m月 %d日, %H:%M %Z|agohover</span>\n</body>\n</html>\n[[/code]]\n--]",
  "tags": [
    "jp",
    "リファレンス"
  ],
  "author": "C-take",
  "created_at": "2018-04-09T12:38:40+00:00",
  "updated_at": "2023-10-28T15:27:52+00:00",
  "rating": 11,
  "_site": "scp-jp",
  "_fullname": "wiki-syntax:date"
}